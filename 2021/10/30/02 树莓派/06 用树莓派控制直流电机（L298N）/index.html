<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		06 用树莓派控制直流电机（L298N） | 
	 
	Hexo
	</title>
	
	<!-- keywords,description -->
	 

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/favicon.ico">
	


	<!-- search -->
	<script>
		var searchEngine = "https://www.google.com/search?q=";
		if(typeof searchEngine == "undefined" || searchEngine == null || searchEngine == ""){
			searchEngine = "https://www.google.com/search?q=";
		}
		var homeHost = "wujun234.github.io";
		if(typeof homeHost == "undefined" || homeHost == null || homeHost == ""){
			homeHost = window.location.host;
		}
	</script>


	
<link rel="stylesheet" href="/css/main.css">

	
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">


	
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

	
<script src="/js/main.js"></script>

	
		
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>

		
<script src="https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js"></script>

	
	
		<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
	<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?3efe99c287df5a1d6f0d02d187e403c1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<header id="header">
    <a id="title" href="/" class="logo">Hexo</a>

	<ul id="menu">
		<li class="menu-item">
			<a href="/about" class="menu-item-link">ABOUT</a>
		</li>
	

	

		<li class="menu-item">
			<a href="https://github.com/wujun234/uid-generator-spring-boot-starter" class="menu-item-link" target="_blank">
				UidGenerator
			</a>
		</li>
		<li class="menu-item">
			<a href="https://github.com/wujun234" class="menu-item-link" target="_blank">
				<i class="fa fa-github fa-2x"></i>
			</a>
		</li>
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="search" placeholder="按回车全站搜索">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										01 数据机构与算法
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/10/30/01%20%E6%95%B0%E6%8D%AE%E6%9C%BA%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/00-%E4%BB%8B%E7%BB%8D/">
										00-介绍
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/01%20%E6%95%B0%E6%8D%AE%E6%9C%BA%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/01-%E7%BA%BF%E6%80%A7%E8%A1%A8/">
										01-线性表
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/01%20%E6%95%B0%E6%8D%AE%E6%9C%BA%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/02-%E6%A0%88%E5%92%8C%E9%98%9F%E5%88%97/">
										02-栈和队列
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/01%20%E6%95%B0%E6%8D%AE%E6%9C%BA%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/03-%E4%B8%B2/">
										03-串
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/01%20%E6%95%B0%E6%8D%AE%E6%9C%BA%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/04-%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86%E5%92%8C%E7%BA%BF%E7%B4%A2%E4%BA%8C%E5%8F%89%E6%A0%91/">
										04-二叉树的遍历和线索二叉树
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/01%20%E6%95%B0%E6%8D%AE%E6%9C%BA%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/05-%E6%8E%92%E5%BA%8F/">
										05-排序
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/01%20%E6%95%B0%E6%8D%AE%E6%9C%BA%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%BA%90%E7%A0%81/">
										数据结构源码
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										02 树莓派
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/10/30/02%20%E6%A0%91%E8%8E%93%E6%B4%BE/01.%E9%95%9C%E5%83%8F%E7%83%A7%E5%BD%95/">
										01.镜像烧录
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/02%20%E6%A0%91%E8%8E%93%E6%B4%BE/02%20%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">
										02 环境搭建
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/02%20%E6%A0%91%E8%8E%93%E6%B4%BE/03%20%E5%AE%89%E8%A3%85OpenCV/">
										03 安装OpenCV
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/02%20%E6%A0%91%E8%8E%93%E6%B4%BE/04%20%E8%BF%90%E8%A1%8C%E5%AE%9E%E4%BE%8B/">
										04 运行实例
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/02%20%E6%A0%91%E8%8E%93%E6%B4%BE/05%20%E5%A5%BD%E7%8E%A9%E7%9A%84/">
										05 好玩的
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file active">
									<a href="/2021/10/30/02%20%E6%A0%91%E8%8E%93%E6%B4%BE/06%20%E7%94%A8%E6%A0%91%E8%8E%93%E6%B4%BE%E6%8E%A7%E5%88%B6%E7%9B%B4%E6%B5%81%E7%94%B5%E6%9C%BA%EF%BC%88L298N%EF%BC%89/">
										06 用树莓派控制直流电机（L298N）
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/02%20%E6%A0%91%E8%8E%93%E6%B4%BE/07%20RPi.GPIO.%E6%A8%A1%E5%9D%97%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/">
										07 RPi.GPIO.模块使用基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/02%20%E6%A0%91%E8%8E%93%E6%B4%BE/08%2057%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA/">
										08 57步进电机
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/02%20%E6%A0%91%E8%8E%93%E6%B4%BE/09%20%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%E5%8F%91%E9%80%81IP%E5%9C%B0%E5%9D%80%E5%88%B0%E9%82%AE%E7%AE%B1/">
										09 开机自动发送IP地址到邮箱
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/02%20%E6%A0%91%E8%8E%93%E6%B4%BE/%E9%97%AE%E9%A2%98/">
										问题
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										03 前端
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/10/30/03%20%E5%89%8D%E7%AB%AF/00%20HTTP%20%E7%8A%B6%E6%80%81%E6%B6%88%E6%81%AF/">
										00 HTTP 状态消息
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/03%20%E5%89%8D%E7%AB%AF/01%20HTML%E5%85%A5%E9%97%A8%E4%B8%8E%E5%AE%9E%E6%88%98/">
										01 HTML入门与实战
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/03%20%E5%89%8D%E7%AB%AF/JavaScript%20%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%20%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%20%E7%AE%80%E5%8D%95%E8%B5%8B%E5%80%BC%20%E5%AF%B9%E8%B1%A1%E5%BC%95%E7%94%A8/">
										JavaScript 基本类型 引用类型 简单赋值 对象引用
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/10/30/03%20%E5%89%8D%E7%AB%AF/JavaScript%20%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%80%BC/">
										JavaScript 深入了解基本类型和引用类型的值
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content">
		<h1 id="article-title">

	06 用树莓派控制直流电机（L298N）
</h1>
<div class="article-meta">
	
	<span>John Doe</span>
	<span>2021-10-30 17:35:03</span>
		<div id="article-categories">
    
		<span>Categories：</span>
            
    

    
		<span>Tags：</span>
            
    
		</div>

</div>

<div id="article-content">
	<ul>
<li><p>直流电机的基本知识。</p>
</li>
<li><p>L298N双H桥直流电机驱动模块相关知识。</p>
</li>
<li><p>如何控制直流电机的转向和转速。</p>
</li>
<li><p>一个小型直流电机。</p>
</li>
<li><p>一个可以为小型直流电机供电的电源，为便于后续的实验，我们这里使用一个3V-24V的直流可调电源。</p>
</li>
<li><p>一个L298N直流电机驱动模块。</p>
</li>
</ul>
<h1 id="1-直流电机"><a href="#1-直流电机" class="headerlink" title="1.直流电机"></a>1.直流电机</h1><p>直流电机是一种将直流电能转换为机械能的装置，被广泛的用于驱动各种设备，如电风扇、遥控小车、电动车窗等，非常适合作为机器人的行走机构，您可以很容易的在网上购买到，价格也不是很贵。<br> 　　小型直流电机的的电压范围通常是1.5V~30V，使用两根导线连接到直流电源上就能让电机转动起来，电压越高转得就越快。每个直流电机都有一个推荐电压，超出推荐电压太多容易导致电机被烧毁，而供电电压太低则转不起来。通过交换两根连接在电机上的导线顺序（实际上是改变电源的正负极），可以改变电机的转向。前面章节我们说过，直流电机属于高功耗元件，不可以直接使用树莓派进行驱动，因此我们需要使用一个外部电源。<br> 　　小型直流电机通常输出很高的转速和较低的扭矩，在作为机器人的驱动装置时，一般需要连接一个变速器，将其转换为低转速、高扭矩，使之有足够的力量驱动机器人。图7.1是典型的带变速器的小型直流电机，建议变速器和电机一起购买。</p>
<p><img src="E:\大三上\树莓派学习\笔记\6.用树莓派控制直流电机（L298N）.assets\13532817-f31f5406bfcace7b.png" alt="img"></p>
<h1 id="2-双H桥直流电机驱动模块（L298N）"><a href="#2-双H桥直流电机驱动模块（L298N）" class="headerlink" title="2.双H桥直流电机驱动模块（L298N）"></a>2.双H桥直流电机驱动模块（L298N）</h1><p>H桥（H-Bridge）是控制直流电机的常用电路，因其电路形状酷似字母H而得名，可以控制直流电机的转速和方向，典型的H桥芯片有L293D、L298N等，以下我们以L298N为例进行介绍。实际使用的时候，为提高芯片的安全性、可靠性和方便性，我们一般会给芯片外接一些保护电路，并把输入输出引脚引接到排针上，从而形成一个功能模块。图7.2是一款典型的L298N双H桥直流电机驱动模块，可以很容易从网上购买到，价格也便宜。该模块的主要特点如下：</p>
<p><img src="E:\大三上\树莓派学习\笔记\6.用树莓派控制直流电机（L298N）.assets\13532817-d33ac6916eb9f32c.png" alt="img"></p>
<ul>
<li><p>采用L298N双桥直流电机驱动芯片</p>
</li>
<li><p>工作电压范围5V35V，如果需要从模块内取电，则供电范围为7V35V</p>
</li>
<li><p>峰值输出电流2A</p>
</li>
<li><p>每个通道有一个使能输入端</p>
</li>
<li><p>可以驱动两个直流电机或者一个四线步进电机</p>
<p>　L298N双H桥直流电机驱动模块的引脚可以归纳成电源、控制和输出等三大类，下面是各类引脚的功能说明。</p>
</li>
<li><p><strong>电压类引脚</strong></p>
<p>　+12V输入：L298N芯片的电源正极，模块上标称+12V，但实际范围可以是5V35V，如果需从模块内取电，则其范围为7V35V。<br>　　GND：L298N芯片的电源地，使用的时候应该把树莓派的GND接到这里，即两者需要共地。<br>　　+5V输出：L298N芯片输出的5V电源，可以给外部设备供电，使用的时候需要用跳线把5V输出使能端短接起来。</p>
</li>
<li><p><strong>控制类引脚</strong></p>
<p>　ENA、ENB：A、B通道的使能端，高电平有效，可以用PWM来实现调速。使用时，可以接到树莓派的GPIO上，实现用程序进行控制。<br>　　IN1、IN2、IN3、IN4：IN1、IN2为A通道的控制输入，IN3、IN4为B通道的控制输入。</p>
</li>
<li><p><strong>输出类引脚</strong></p>
<p>　OUT1、OUT2、OUT3、OUT4：OUT1、OUT2由A通道输出，OUT3、OUT4由B通道输出，可以用于连接直流电机等设备。</p>
<p>　控制直流电机的转向和转速实际是通过给控制类引脚设置不同的值来实现的，表7.1是使用通道A的控制直流电机的真值表，通道B与此类似。</p>
</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/13532817-d724bfe24fac8005.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/421/format/webp" alt="img"></p>
<p>通道A的控制直流电机的真值表</p>
<blockquote>
<p><strong>提示：</strong></p>
<p>您购买到的L298N双H桥直流电机驱动模块可能与本章介绍的存在一定的差异，但这一类功能模块大同小异，请跟商家索要相应的技术资料了解更多的使用细节。</p>
</blockquote>
<h1 id="3-让直流电机动起来"><a href="#3-让直流电机动起来" class="headerlink" title="3. 让直流电机动起来"></a>3. 让直流电机动起来</h1><p> 　下面进入实战环节，我们将用树莓派通过L298N双H桥直流电机驱动模块控制一个电机的转向和转速。为了能让读者更好的理解，我们首先演示如何控制电机的转向，然后再进一步介绍如何控制电机转速。</p>
<h2 id="3-1-实验电路"><a href="#3-1-实验电路" class="headerlink" title="3.1 实验电路"></a>3.1 实验电路</h2><p> 　图7.3所示的是树莓派、L298N双H桥直流电机驱动模块和电机间连接的电路图，最终实物连线图如图7.4所示。我们使用树莓派的GPIO13、GPIO19和GPIO26等3个引脚，分别连接到L298N双H桥直流电机驱动模块的ENA、IN1和IN2，通过输入表7.1所示的不同电平组合就可以实现对电机的操纵。控制电机的转向和转速都是使用该电路，向ENA输入不同占空比的PWM脉冲信号就可以控制电机的转速。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/13532817-ac38b15a79d6272d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/436/format/webp" alt="img"></p>
<p>图 7.3 小型直流电机控制电路图</p>
<p><img src="https://upload-images.jianshu.io/upload_images/13532817-e41c49bbc602d114.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/756/format/webp" alt="img"></p>
<p> 　尽管L298N双H桥直流电机驱动模块能驱动两个直流电机，但我们只演示如何驱动一个。驱动两个电机使用的是相同的技术，如果在您的项目中需要用到两个，也可以很容易地扩展它。</p>
<h2 id="3-2-程序思路"><a href="#3-2-程序思路" class="headerlink" title="3.2 程序思路"></a>3.2 程序思路</h2><p> 　控制电机转向和转速可以使用同一个电路，但程序思路上我们分两个程序来演示，具体思路如下：</p>
<ul>
<li><strong>控制电机转向思路</strong></li>
</ul>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span>  </span><br><span class="line">    引入GPIO库  </span><br><span class="line">    将连接ENA的GPIO引脚设置为输出模式</span><br><span class="line">    将连接IN1的GPIO引脚设置为输出模式</span><br><span class="line">    将连接IN2的GPIO引脚设置为输出模式</span><br><span class="line">    </span><br><span class="line">    DO FOREVER  </span><br><span class="line">        将IN1设置为<span class="number">0</span>，IN2设置为<span class="number">1</span>，将电机设置为正向转动  </span><br><span class="line">        将ENA设置为<span class="number">1</span>，驱动A通道电机转动  </span><br><span class="line">        等待<span class="number">5</span>秒  </span><br><span class="line"></span><br><span class="line">        将ENA设置为<span class="number">0</span>，停止电机转动  </span><br><span class="line">        等待<span class="number">2</span>秒  </span><br><span class="line"></span><br><span class="line">        将IN1设置为<span class="number">1</span>，IN2设置为<span class="number">0</span>，将电机设置为反向转动  </span><br><span class="line">        将ENA设置为<span class="number">1</span>，驱动A通道电机转动  </span><br><span class="line">        等待<span class="number">5</span>秒  </span><br><span class="line"></span><br><span class="line">        将ENA设置为<span class="number">0</span>，停止电机转动  </span><br><span class="line">        等待<span class="number">2</span>秒</span><br><span class="line">    ENDO  </span><br><span class="line">    停止PWM  </span><br><span class="line">    清理释放GPIO资源  </span><br><span class="line"><span class="keyword">END</span>  </span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>提示：</strong></p>
<p>除了采用将ENA置0的方法来让电机停止转动，将IN1和IN2同时设置为0或1也可以让电机停止下来。</p>
</blockquote>
<ul>
<li><strong>控制电机转速思路</strong></li>
</ul>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span>  </span><br><span class="line">    引入GPIO库  </span><br><span class="line">    将连接ENA的GPIO引脚设置为输出模式</span><br><span class="line">    将连接IN1的GPIO引脚设置为输出模式</span><br><span class="line">    将连接IN2的GPIO引脚设置为输出模式</span><br><span class="line"></span><br><span class="line">    设置ENA输入一定频率的PWM脉冲信号，创建PWM对象  </span><br><span class="line">    开始向ENA输入占空比为<span class="number">0</span>的PWM脉冲信号  </span><br><span class="line">    </span><br><span class="line">    DO FOREVER  </span><br><span class="line">        将IN1设置为<span class="number">0</span>，IN2设置为<span class="number">1</span>，将电机设置为正向转动  </span><br><span class="line">        将ENA设置为<span class="number">1</span>，驱动A通道电机转动  </span><br><span class="line">        </span><br><span class="line">        speed = <span class="number">0</span></span><br><span class="line">        DOWHILE speed &lt; <span class="number">100</span>  </span><br><span class="line">            将输入ENA的PWM脉冲信号的占空比修改为speed</span><br><span class="line">            speed += <span class="number">5</span></span><br><span class="line">            等待<span class="number">1</span>秒</span><br><span class="line">        ENDDO</span><br><span class="line"></span><br><span class="line">        将IN1设置为<span class="number">1</span>，IN2设置为<span class="number">0</span>，将电机设置为反向转动  </span><br><span class="line">        将ENA设置为<span class="number">1</span>，驱动A通道电机转动  </span><br><span class="line">        </span><br><span class="line">        speed = <span class="number">0</span></span><br><span class="line">        DOWHILE speed &lt; <span class="number">100</span>  </span><br><span class="line">            将输入ENA的PWM脉冲信号的占空比修改为speed</span><br><span class="line">            speed += <span class="number">5</span></span><br><span class="line">            等待<span class="number">1</span>秒</span><br><span class="line">        ENDDO</span><br><span class="line">    ENDO  </span><br><span class="line">    </span><br><span class="line">    停止PWM  </span><br><span class="line">    清理释放GPIO资源  </span><br><span class="line"><span class="keyword">END</span>  </span><br></pre></td></tr></table></figure>

<p> 　电机的转向控制和转速控制的程序思路的最大区别在于ENA输入信号的不同。控制电机转向的程序思路只是简单的通过将ENA设置为1或0来启动和停止电机。对于电机转速控制，ENA输入的PWM脉冲信号，通过改变PWM脉冲信号的占空比来改变电机转速，占空比越大速度就越快，占空比为100%时相当于输入1（高电平），占空比为0%时相当于输入0（低电平）。</p>
<h2 id="3-3-程序代码"><a href="#3-3-程序代码" class="headerlink" title="3.3 程序代码"></a>3.3 程序代码</h2><p> 　以下是直流电机转向和转速控制程序，程序的详细说明见注释。</p>
<ul>
<li><strong>控制电机转向程序</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> RPi.GPIO <span class="keyword">as</span> GPIO         <span class="comment"># 引入GPIO模块</span></span><br><span class="line"><span class="keyword">import</span> time                     <span class="comment"># 引入time模块</span></span><br><span class="line"></span><br><span class="line">ENA = <span class="number">13</span>                        <span class="comment"># 设置GPIO13连接ENA</span></span><br><span class="line">IN1 = <span class="number">19</span>                        <span class="comment"># 设置GPIO19连接IN1</span></span><br><span class="line">IN2 = <span class="number">26</span>                        <span class="comment"># 设置GPIO26连接IN2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 初始化</span></span><br><span class="line">        GPIO.setmode(GPIO.BCM)          <span class="comment"># 使用BCM编号方式</span></span><br><span class="line">        GPIO.setup(ENA, GPIO.OUT)       <span class="comment"># 将连接ENA的GPIO引脚设置为输出模式</span></span><br><span class="line">        GPIO.setup(IN1, GPIO.OUT)       <span class="comment"># 将连接IN1的GPIO引脚设置为输出模式</span></span><br><span class="line">        GPIO.setup(IN2, GPIO.OUT)       <span class="comment"># 将连接IN2的GPIO引脚设置为输出模式</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># 驱动电机正向旋转5秒</span></span><br><span class="line">            GPIO.output(IN1, <span class="literal">False</span>)     <span class="comment"># 将IN1设置为0</span></span><br><span class="line">            GPIO.output(IN2, <span class="literal">True</span>)      <span class="comment"># 将IN2设置为1</span></span><br><span class="line">            GPIO.output(ENA, <span class="literal">True</span>)      <span class="comment"># 将ENA设置为1，启动A通道电机</span></span><br><span class="line">            time.sleep(<span class="number">5</span>)               <span class="comment"># 等待电机转动5秒</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 电机停止2秒</span></span><br><span class="line">            GPIO.output(ENA, <span class="literal">False</span>)     <span class="comment"># 将ENA设置为0</span></span><br><span class="line">            time.sleep(<span class="number">2</span>)               <span class="comment"># 等待电机停止2秒</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 驱动电机反向旋转5秒</span></span><br><span class="line">            GPIO.output(IN1, <span class="literal">True</span>)      <span class="comment"># 将IN1设置为1</span></span><br><span class="line">            GPIO.output(IN2, <span class="literal">False</span>)     <span class="comment"># 将IN2设置为0</span></span><br><span class="line">            GPIO.output(ENA, <span class="literal">True</span>)      <span class="comment"># 将ENA设置为1，启动A通道电机</span></span><br><span class="line">            time.sleep(<span class="number">5</span>)               <span class="comment"># 等待电机转动5秒</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 电机停止2秒</span></span><br><span class="line">            GPIO.output(ENA, <span class="literal">False</span>)     <span class="comment"># 将ENA设置为0</span></span><br><span class="line">            time.sleep(<span class="number">2</span>)               <span class="comment"># 等待电机停止2秒</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        pwm.stop()                      <span class="comment"># 停止PWM</span></span><br><span class="line">        GPIO.cleanup()                  <span class="comment"># 清理释放GPIO资源，将GPIO复位</span></span><br></pre></td></tr></table></figure>

<p> 　运行这个程序后，您将看到直流电机反复的正向转动5秒后，停止两秒，再反向转动5秒后，停止2秒。</p>
<ul>
<li><strong>控制电机转速程序</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> RPi.GPIO <span class="keyword">as</span> GPIO         <span class="comment"># 引入GPIO模块</span></span><br><span class="line"><span class="keyword">import</span> time                     <span class="comment"># 引入time模块</span></span><br><span class="line"></span><br><span class="line">ENA = <span class="number">13</span>                        <span class="comment"># 设置GPIO13连接ENA</span></span><br><span class="line">IN1 = <span class="number">19</span>                        <span class="comment"># 设置GPIO19连接IN1</span></span><br><span class="line">IN2 = <span class="number">26</span>                        <span class="comment"># 设置GPIO26连接IN2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 初始化</span></span><br><span class="line">        GPIO.setmode(GPIO.BCM)              <span class="comment"># 使用BCM编号方式</span></span><br><span class="line">        GPIO.setup(ENA, GPIO.OUT)           <span class="comment"># 将ENA对应的GPIO引脚设置为输出模式</span></span><br><span class="line">        GPIO.setup(IN1, GPIO.OUT)           <span class="comment"># 将IN1对应的GPIO引脚设置为输出模式</span></span><br><span class="line">        GPIO.setup(IN2, GPIO.OUT)           <span class="comment"># 将IN2对应的GPIO引脚设置为输出模式</span></span><br><span class="line"></span><br><span class="line">        freq = <span class="number">500</span></span><br><span class="line">        speed = <span class="number">0</span></span><br><span class="line">        pwm = GPIO.PWM(ENA, freq)           <span class="comment"># 设置向ENA输入PWM脉冲信号，频率为freq并创建PWM对象</span></span><br><span class="line">        pwm.start(speed)                    <span class="comment"># 以speed的初始占空比开始向ENA输入PWM脉冲信号</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># 将电机设置为正向转动</span></span><br><span class="line">            GPIO.output(IN1, <span class="literal">False</span>)         <span class="comment"># 将IN1设置为0</span></span><br><span class="line">            GPIO.output(IN2, <span class="literal">True</span>)          <span class="comment"># 将IN2设置为1</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 通过改变PWM占空比，让电机转速不断加快</span></span><br><span class="line">            <span class="keyword">for</span> speed <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">100</span>, <span class="number">5</span>):</span><br><span class="line">                pwm.ChangeDutyCycle(speed)  <span class="comment"># 改变PWM占空比</span></span><br><span class="line">                time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 将电机设置为反向转动</span></span><br><span class="line">            GPIO.output(IN1, <span class="literal">True</span>)          <span class="comment"># 将IN1设置为1</span></span><br><span class="line">            GPIO.output(IN2, <span class="literal">False</span>)         <span class="comment"># 将IN2设置为0</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 通过改变PWM占空比，让电机转速不断加快</span></span><br><span class="line">            <span class="keyword">for</span> speed <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">100</span>, <span class="number">5</span>):</span><br><span class="line">                pwm.ChangeDutyCycle(speed)  <span class="comment"># 改变PWM占空比</span></span><br><span class="line">                time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        pwm.stop()                          <span class="comment"># 停止PWM</span></span><br><span class="line">        GPIO.cleanup()                      <span class="comment"># 清理释放GPIO资源，将GPIO复位</span></span><br></pre></td></tr></table></figure>

<p> 　运行这个程序后，您将看到直流电机首先正向转动，转动速度不断增加，在达到最大转速后，直流电机短暂停止转动，然后反向转动，转动速度不断增加，如此反复运动。</p>
<h1 id="4-本章小结"><a href="#4-本章小结" class="headerlink" title="4 .本章小结"></a>4 .本章小结</h1><p> 　本章首先介绍了直流电机的基本知识，然后介绍了L298N双H桥直流电机驱动模块的相关基础知识，最后介绍了使用树莓派和L298N双H桥直流电机驱动模块来控制一个直流电机的转向和转速的电路、思路和程序等知识。</p>

</div>


    <div class="post-guide">
        <div class="item left">
            
              <a href="/2021/10/30/02%20%E6%A0%91%E8%8E%93%E6%B4%BE/07%20RPi.GPIO.%E6%A8%A1%E5%9D%97%E4%BD%BF%E7%94%A8%E5%9F%BA%E7%A1%80/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  07 RPi.GPIO.模块使用基础
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/2021/10/30/02%20%E6%A0%91%E8%8E%93%E6%B4%BE/05%20%E5%A5%BD%E7%8E%A9%E7%9A%84/">
                05 好玩的
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>



	<div id="vcomments"></div>


<script>
	
		// 评论
		new Valine({
			av: AV,
			el: '#vcomments',
			notify: false,
			verify: false,
			path: window.location.pathname,
			appId: '',
			appKey: '',
			placeholder: '请输入评论',
			avatar: 'retro',
			recordIP: false
		})
	
	
</script>
	</div>
	<div id="footer">
	<p>
	©2019-<span id="footerYear"></span> 
	<a href="/">John Doe</a> 
	
	
		|
		<span id="busuanzi_container_site_pv">
			pv
			<span id="busuanzi_value_site_pv"></span>
		</span>
		|
		<span id="busuanzi_container_site_uv"> 
			uv
			<span id="busuanzi_value_site_uv"></span>
		</span>
	
	<br>
	Theme <a href="//github.com/wujun234/hexo-theme-tree" target="_blank">Tree</a>
	by <a href="//github.com/wujun234" target="_blank">WuJun</a>
	Powered by <a href="//hexo.io" target="_blank">Hexo</a>
	</p>
</div>
<script type="text/javascript"> 
	document.getElementById('footerYear').innerHTML = new Date().getFullYear() + '';
</script>
	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>